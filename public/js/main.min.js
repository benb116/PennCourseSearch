function ListScheds(a,b){$("#schedSelect").empty();for(var c in a)a.hasOwnProperty(c)&&$("#schedSelect").append('<option value="'+a[c]+'">'+a[c]+"</option>");if($("#schedSelect").append('<option value="createNewSched">New Schedule</option>'),0==b)var d=a[0];else var d=a[a.length-1];$('#schedSelect option[value="'+d+'"]').attr("selected","selected");var e="/Sched?addRem=blank&courseID=blank&schedName="+d;SendReq(e,SpitSched,[])}function initiateSearch(){var a=$("#CSearch").val();try{if(""!=a&&"favicon.ico"!=a&&"blank"!=a){var b=$("#searchSelect").val();if("courseIDSearch"==b){var c=formatCourseID(a),d=c.split("/")[0],e=c.split("/")[1],f=c.split("/")[2];if("undefined"==typeof e)var e="";if("undefined"==typeof f)var f=""}else var d=a,e="",f="";var b=$("#searchSelect").val();getCourseNumbers(d,b,TitleHidden),3==e.length?getSectionNumbers(d+e,"all"):($("#SectionTitle").empty(),$("#SectionList").empty()),3==f.length?getSectionInfo(d+e+f):$("#SectionInfo").empty()}else""!=a&&($("#CourseList").empty(),$("#SectionTitle").empty(),$("#SectionList").empty(),$("#SectionInfo").empty())}catch(g){console.log("No Results "+g)}}function formatCourseID(a){return splitTerms=a.replace(/ /g,"").replace(/-/g,"").replace(/:/g,""),parseFloat(splitTerms[2])==splitTerms[2]?(splitTerms=splitTerms.substr(0,2)+"/"+splitTerms.substr(2),parseFloat(splitTerms[6])==splitTerms[6]&&(splitTerms=splitTerms.substr(0,6)+"/"+splitTerms.substr(6))):parseFloat(splitTerms[3])==splitTerms[3]?(splitTerms=splitTerms.substr(0,3)+"/"+splitTerms.substr(3),parseFloat(splitTerms[7])==splitTerms[7]&&(splitTerms=splitTerms.substr(0,7)+"/"+splitTerms.substr(7))):parseFloat(splitTerms[4])==splitTerms[4]&&(splitTerms=splitTerms.substr(0,4)+"/"+splitTerms.substr(4),parseFloat(splitTerms[8])==splitTerms[8]&&(splitTerms=splitTerms.substr(0,8)+"/"+splitTerms.substr(8))),splitTerms}function ClickTriggers(){$("body").on("click","#CourseList li",function(){$("#SectionInfo").empty();var a=$(this).html().split("<")[0].replace(/ /g," "),b=$("#searchSelect").val(),c="all";if("instSearch"==b)var c=$("#CSearch").val();getSectionNumbers(a,c)}),$("body").on("click","#SectionList span:nth-child(1)",function(){var a=$(this).next().next().html().split("-")[0].replace(/ /g,""),b=$("#schedSelect").val();addToSched(a,b)}),$("body").on("click","#SectionList span:nth-child(3)",function(){var a=$(this).html().split("-")[0].replace(/ /g,"");getSectionInfo(a);var b=a.slice(0,-6);getCourseNumbers(b,"courseIDSearch",TitleHidden)}),$("body").on("click","#SectionList i",function(){var a=$(this).attr("class");"fa fa-star-o"==a?addRem="add":"fa fa-star"==a&&(addRem="rem"),Stars(addRem,$(this).prev().html().split("-")[0].replace(/ /g,"")),$(this).toggleClass("fa-star"),$(this).toggleClass("fa-star-o"),"rem"==addRem&&"starredSec"==$(this).parent().attr("class")&&$(this).parent().remove()}),$("body").on("click",".DescBlock",function(){$("#SectionInfo p").toggle()}),$("body").on("click","#SectionInfo span:nth-child(1)",function(){var a=$(this).next().html().replace(/ /g,""),b=$("#schedSelect").val();addToSched(a,b)}),$("body").on("click",".AsscText span:nth-child(2)",function(){var a=$(this).html().replace(/ /g," ");getSectionInfo(a)}),$("body").on("click",".CloseX",function(a){var b=$("#schedSelect").val();removeFromSched($(this).parent().attr("id"),b),a.stopPropagation()}),$("body").on("mouseover",".SchedBlock",function(){$(this).find(".CloseX").css("opacity","1")}),$("body").on("mouseout",".SchedBlock",function(){$(this).find(".CloseX").css("opacity","0")}),$("body").on("click",".SchedBlock",function(){sec=$(this).attr("id");for(var a=7;a<sec.length;a++)if(parseFloat(sec[a])!=sec[a]){secname=sec.substr(0,a);break}var b=secname.slice(0,-3),c=secname.slice(0,-6);getSectionInfo(secname),getSectionNumbers(b,"all"),getCourseNumbers(c,"courseIDSearch",TitleHidden)})}function SendReq(a,b,c){LoadingSum+=1,LoadingIndicate(),$.get(a).done(function(a){b(a,c)}).always(function(){LoadingSum-=1,LoadingIndicate()})}function LoadingIndicate(){LoadingSum>0?$("#LoadingInfo").css("opacity","1"):$("#LoadingInfo").css("opacity","0")}function getCourseNumbers(a,b){var d="/Search?searchType="+b+"&resultType=deptSearch&searchParam="+a;SendReq(d,CourseFormat,[])}function CourseFormat(a){"string"==typeof a&&(a=JSON.parse(a));var c="";if($.isEmptyObject(a))c="&nbsp&nbsp&nbsp&nbsp&nbspNo Results";else for(var d in a)a.hasOwnProperty(d)&&(c+="<li>"+a[d].courseListName+'<span class="CourseTitle"> - '+a[d].courseTitle+"</span></li>");$("#CourseList").html(c),TitleHidden===!1&&$(".CourseTitle").toggle()}function getSectionNumbers(a,b){searchURL="/Search?searchType=courseIDSearch&resultType=numbSearch&searchParam="+a+"&instFilter="+b,SendReq(searchURL,SectionStars,[])}function SectionStars(a){searchURL="/Star?addRem=blank&courseID=blank",SendReq(searchURL,FormatSectionsList,a)}function FormatSectionsList(a,b){var c="";for(var d in b)if(b.hasOwnProperty(d)){var e="fa fa-star-o",f=a.indexOf(b[d].NoSpace);if(f>-1)var e="fa fa-star";c+='<li><span>&nbsp + &nbsp</span><span class="'+b[d].StatusClass+'">&nbsp&nbsp&nbsp&nbsp&nbsp</span>&nbsp;&nbsp;<span>'+b[d].SectionName+b[d].TimeInfo+'</span><i class="'+e+'"></i></li>'}"undefined"==typeof d?($("#SectionTitle").html("No Results"),$("#SectionList").empty()):($("#SectionTitle").html(b[d].CourseTitle),$("#SectionList").html(c))}function getSectionInfo(a){searchURL="/Search?searchType=courseIDSearch&resultType=sectSearch&searchParam="+a,SendReq(searchURL,SectionInfoFormat,[])}function SectionInfoFormat(a){if("No Results"==a)$("#SectionInfo").html("No Results");else{var c="<span>&nbsp + &nbsp</span><span>"+a.FullID+"</span> - "+a.Title+"<br><br>Instructor: "+a.Instructor+"<br><br>Description:<br><p class='DescText'>"+a.Description+"</p><br>Status: "+a.OpenClose+"<br><br>"+a.termsOffered+"<br><br>Prerequisites: "+a.Prerequisites+"<br><br>"+a.TimeInfo+a.AssociatedSections;$("#SectionInfo").html(c)}}function Stars(a,b){var c="/Star?addRem="+a+"&courseID="+b;SendReq(c,StarHandle,a)}function StarHandle(a,b){if("show"!=b)return a;$("#SectionList").empty();for(var c in a)if(a.hasOwnProperty(c)){var d="/Search?searchType=courseIDSearch&resultType=numbSearch&searchParam="+a[c]+"&instFilter=all";SendReq(d,StarFormat,[])}}function StarFormat(a){var b="fa fa-star";for(var c in a)if(a.hasOwnProperty(c)){console.log(a[c]);var d='<li class="starredSec"><span>&nbsp + &nbsp</span><span class="'+a[c].StatusClass+'">&nbsp&nbsp&nbsp&nbsp&nbsp</span>&nbsp;&nbsp;<span>'+a[c].SectionName+a[c].TimeInfo+'</span><i class="'+b+'"></i></li>'}$("#SectionTitle").html("Starred Sections"),$("#SectionList").append(d)}function addToSched(a,b){var c="/Sched?addRem=add&schedName="+b+"&courseID="+a;SendReq(c,SpitSched,[])}function removeFromSched(a,b){for(var c=7;c<a.length;c++)if(parseFloat(a[c])!=a[c]){secname=a.substr(0,c);break}var d="/Sched?addRem=rem&schedName="+b+"&courseID="+secname;SendReq(d,SpitSched,[])}function clearSched(){var a=$("#schedSelect").val();schedURL="/Sched?addRem=clear&schedName="+a,SendReq(schedURL,SpitSched,[]),$(".tooltip").tooltipster("hide")}function SpitSched(a){$("#Schedule").empty(),$("#TimeCol").empty();var b=["M","T","W","R","F"],c=10,d=18,e=20;incSun=0,incSat=0;for(var f in a)if(a.hasOwnProperty(f)){a[f].meetHour<=c&&(c=a[f].meetHour),a[f].meetHour+a[f].HourLength>=d&&(d=a[f].meetHour+a[f].HourLength);for(var g in a[f].meetDay){var h=a[f].meetDay[g];"U"==h&&(incSun=1),"S"==h&&(incSat=1)}}1==incSun&&b.unshift("U"),1==incSat&&b.push("S");var e=100/(5+incSun+incSat),i=100/(d-c+1);if(!$.isEmptyObject(a))for(var j=0;d-c>=j;j++)toppos=j*i+2.5,hourtext=Math.round(j+c),hourtext>12&&(hourtext-=12),$("#TimeCol").append('<div class="TimeBlock" style="top:'+toppos+'%">'+hourtext+":00</div>"),$("#Schedule").append('<hr width="100%"style="top:'+toppos+'%" >');var k={},l=0;for(var f in a)a.hasOwnProperty(f)&&(k[a[f].fullCourseName]=colorPalette[l],l+=1);for(var f in a)if(a.hasOwnProperty(f))for(var g in a[f].meetDay)if(a[f].meetDay.hasOwnProperty(g)){var h=a[f].meetDay[g];for(var m in b)if(b[m]==h){var n=m*e;break}var o=(a[f].meetHour-c)*i+4,p=a[f].HourLength*i,q=a[f].fullCourseName,r=a[f].meetRoom,s=k[a[f].fullCourseName];"undefined"==typeof s&&(s="#E6E6E6"),$("#Schedule").append('<div class="SchedBlock" id="'+f+'" style="top:'+o+"%;left:"+n+"%;width:"+e+"%;height:"+p+"%;background-color:"+s+'"><div class="CloseX">x</div>'+q+"<br>"+r+"</div>")}}function detectIE(){var a=window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf("Trident/");return b>0||c>0?!0:!1}$(document).ready(function(){function b(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}$("#clearTool").tooltipster({trigger:"click",position:"bottom",interactive:"true",content:$('<span onclick="clearSched();">Confirm</span>')}),detectIE()&&$("#LoadingInfo").html("Loading ...");var a=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}();LoadingSum=0,TitleHidden=!0,colorPalette=["#1abc9c","#e74c3c","#f1c40f","#3498db","#9b59b6","#e67e22","#ecf0f1","#2ecc71","#95a5a6","#FF73FD","#73F1FF","#CA75FF"];var c="/Sched?addRem=name&courseID=blank";SendReq(c,ListScheds,0),$("#Top span").click(function(){if("Download Schedule"==$(this).html()&&html2canvas($("#SchedGraph"),{onrendered:function(a){var b=new Image;b.src=a.toDataURL("image/png"),window.open(b.src,"_blank")}}),"Recolor"==$(this).html()){newcolorPalette=b(colorPalette);var a=$("#schedSelect").val(),c="/Sched?addRem=blank&courseID=blank&schedName="+a;SendReq(c,SpitSched,[])}}),ClickTriggers(),$("#searchSelect").change(function(){initiateSearch()}),$("#schedSelect").change(function(){var a=$("#schedSelect").val();if("createNewSched"==a){var a=prompt("Please enter a name for your new schedule.");if(""!=a){var b="/Sched?addRem=name&courseID=blank&schedName="+a;SendReq(b,ListScheds,-2)}}else{var b="/Sched?addRem=blank&courseID=blank&schedName="+a;SendReq(b,SpitSched,[])}}),$("#CSearch").on("input",function(){a(function(){initiateSearch()},500)})});